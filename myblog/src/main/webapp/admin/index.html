<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>ç®¡ç†ä¸­å¿ƒ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta content="Coderthemes" name="author"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <link rel="shortcut icon" href="../static/image/logo.png"/>
    <link href="../static/plugins/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="../static/plugins/font-awesome-4.7.0/css/font-awesome.css" rel="stylesheet"/>
    <link href="../static/css/style.css" rel="stylesheet" type="text/css"/>
    <style>
        .overflow{
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
    </style>
</head>
<body>
<div id="wrapper">
    <!--å¤´éƒ¨å’Œå·¦è¾¹èœå•-->
    <div>
        <div class="topbar">
            <div class="topbar-left">
                <div class="text-center p-t-10" style="margin: 0 auto;">
                    <div class="pull-left" style="padding-left: 10px;">
                        <a href="index.html">
                            <img src="../static/image/logo.png" width="50" height="50"/>
                        </a>
                    </div>
                    <div class="pull-left" style="padding-left: 10px;">
                        <span style="font-size: 20px; color: #2f353f; line-height: 50px;">æˆ‘çš„åšå®¢</span>
                    </div>
                </div>
            </div>
            <div class="navbar navbar-default" role="navigation">
                <div class="container">
                    <div class="">
                        <div class="pull-left">
                            <button type="button" class="button-menu-mobile open-left">
                                <i class="fa fa-bars"></i>
                            </button>
                            <span class="clearfix"></span>
                        </div>

                        <ul class="nav navbar-nav navbar-right pull-right">
                            <li class="dropdown">
                                <a href="/admin/index.html" class="dropdown-toggle profile" data-toggle="dropdown"
                                   aria-expanded="true">
                                    <span class="glyphicon glyphicon-user"/>
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a href="javascript:void(0);" onclick="logout()"><i class="fa fa-sign-out"></i>
                                        æ³¨é”€</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="left side-menu">
            <div class="sidebar-inner slimscrollleft">
                <div id="sidebar-menu">
                    <ul>
                        <li>
                            <a id="index" href="index.html" class="waves-effect active">
                                <i class="fa fa-dashboard" aria-hidden="true"></i>
                                <span> ä»ªè¡¨ç›˜ </span>
                            </a>
                        </li>
                        <li>
                            <a id="article_edit" href="article_edit.html" class="waves-effect">
                                <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                <span> å‘å¸ƒæ–‡ç«  </span>
                            </a>
                        </li>
                        <li>
                            <a href="article_list.html" class="waves-effect">
                                <i class="fa fa-list" aria-hidden="true"></i>
                                <span> æ–‡ç« ç®¡ç† </span>
                            </a>
                        </li>
                        <li>
                            <a href="comment_list.html" class="waves-effect">
                                <i class="fa fa-comments" aria-hidden="true"></i>
                                <span> è¯„è®ºç®¡ç† </span>
                            </a>
                        </li>
                        <li>
                            <a href="category.html" class="waves-effect">
                                <i class="fa fa-tags" aria-hidden="true"></i>
                                <span> åˆ†ç±»/æ ‡ç­¾ </span>
                            </a>
                        </li>
                        <li>
                            <a href="file.html" class="waves-effect">
                                <i class="fa fa-cloud-upload" aria-hidden="true"></i>
                                <span> æ–‡ä»¶ç®¡ç† </span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="content-page">
        <div class="content">
            <div class="container">
                <div class="row">
                    <div class="row">
                        <div class="col-sm-6 col-lg-4">
                            <div class="mini-stat clearfix bx-shadow bg-info">
                                <span class="mini-stat-icon"><i class="fa fa-quote-right" aria-hidden="true"></i></span>
                                <div class="mini-stat-info text-right">
                                    å‘è¡¨äº†<span class="counter" id="articleCount">10</span>ç¯‡æ–‡ç« 
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-4">
                            <div class="mini-stat clearfix bg-purple bx-shadow">
                                <span class="mini-stat-icon"><i class="fa fa-comments-o" aria-hidden="true"></i></span>
                                <div class="mini-stat-info text-right">
                                    æ”¶åˆ°äº†<span class="counter" id="commentCount">20</span>æ¡ç•™è¨€
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-4">
                            <div class="mini-stat clearfix bg-success bx-shadow">
                                <span class="mini-stat-icon"><i class="fa fa-cloud-upload"
                                                                aria-hidden="true"></i></span>
                                <div class="mini-stat-info text-right">
                                    ä¸Šä¼ äº†<span class="counter" id="attachesCount">50</span>ä¸ªé™„ä»¶
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">æœ€æ–°æ–‡ç« </h4>
                                </div>
                                <div class="panel-body">
                                    <ul class="list-group" id="new_article">
                                        <li class="list-group-item">
                                            <a target="_blank" href="#">æˆ‘çš„å­¦ä¹ ä¹‹è·¯</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">æœ€æ–°è¯„è®º</h4>
                                </div>
                                <div class="panel-body">
                                    <div id="not_comment" class="alert alert-warning">
                                            è¿˜æ²¡æœ‰æ”¶åˆ°è¯„è®º.
                                    </div>
                                    <ul id="comment_ul" class="list-group">
                                        <li class="list-group-item">
                                            <div><a href="#" target="_blank">æˆ‘æ˜¯ç¨‹åºå‘˜</a></div>
                                            è¯„è®ºäºï¼š<span>2019å¹´4æœˆ20æ—¥14:04:53</span><br/>
                                            <a href="#" target="_blank">å¥½æ–‡ç« ï¼Œæ”¯æŒï¼ï¼ï¼</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--é¡µè„š-->
                <div>
                    <footer class="footer text-right">
                        2019 Â© <a href="#" target="_blank">Blog</a>
                        <div class=""></div>
                    </footer>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../static/plugins/jquery/jquery-3.4.0.js"></script>
<script src="../static/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="../static/plugins/jquery/jquery.app.js"></script>
<script src="../static/js/base.js"></script>
<script>
    $(function () {
        $.ajax({
            url:getRootPath()+'/admin/getIndexCount',
            method:'get',
            dataType:'json',
            success:function (res) {
                if(res.code==403){
                    show403();
                }else{
                    $('#articleCount').text(res.articleCount);
                    $('#commentCount').text(res.commentCount);
                    $('#attachesCount').text(res.imgCount);
                }
            },
            error:function (e) {
                alert('è·å–é¦–é¡µç»Ÿè®¡æ•°é‡å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•...');
                console.log(e);
            }
        });

        $.ajax({
            url:getRootPath()+'/admin/getInfoList',
            method:'get',
            dataType:'json',
            success:function (res) {
                if(res.code==403){
                    show403();
                }else{
                    var articleList=res.articleList;
                    var commentList=res.commentList;
                    var articleHtml='';
                    if(articleList.length>0){
                        for(var i=0;i<articleList.length;i++){
                            articleHtml+='<li class="list-group-item" style="clear: left;height: 40px;">';
                            articleHtml+='<div class="overflow" style="width: 350px;float: left;"><a title="'+articleList[i].title+'" target="_blank" href="../post.html?aid='+articleList[i].id+'">'+articleList[i].title+'</a></div>';
                            articleHtml+='<div style="width:200px;float: right;">å‘è¡¨æ—¶é—´:'+articleList[i].created+'</div>';
                            articleHtml+='</li>';
                        }
                    }else{
                        articleHtml+='<li class="list-group-item"><a href="javascript:;">æš‚æ— æ–‡ç« </a></li>';
                    }
                    $('#new_article').empty().append(articleHtml);
                    var commentHtml='';
                    if(commentList.length>0){
                        $('#not_comment').remove();
                        for(var i=0;i<commentList.length;i++){
                            commentHtml+='<li class="list-group-item">';
                            commentHtml+='<div>è¯„è®ºäººï¼š'+commentList[i].name+'</div>';
                            var aname=commentList[i].aname;
                            if(aname.length>30){
                                aname=aname.substr(0,30)+'...';
                            }
                            commentHtml+='<div>è¯„è®ºæ–‡ç« ï¼š<a target="_blank" href="../post.html?aid='+commentList[i].aid+'" title="'+commentList[i].aname+'">'+aname+'</a></div>';
                            commentHtml+='<div>è¯„è®ºæ—¶é—´ï¼š<span>'+commentList[i].created+'</span></div>';
                            if(commentList[i].status==1){
                                commentHtml+='<div>çŠ¶æ€ï¼š<span class="label label-default">æœªå®¡æ ¸</span>ğŸ‘‰<a href="comment_list.html"><span class="label label-default">å®¡æ‰¹</span></a></div>';
                            }else if(commentList[i].status==2){
                                commentHtml+='<div>çŠ¶æ€ï¼š<span class="label label-success">é€šè¿‡</span>ğŸ‘‰<a target="_blank" href="../post.html?aid='+commentList[i].aid+'#comment_list_'+commentList[i].id+'"><span class="label label-success">æŸ¥çœ‹</span></a></div>';
                            }else{
                                commentHtml+='<div>çŠ¶æ€ï¼š<span class="label label-warning">æ‹’ç»</span></div>';
                            }
                            var comment=commentList[i].content;
                            if(comment.length>50){
                                comment=comment.substr(0,50)+'...';
                            }
                            commentHtml+='<div title="'+commentList[i].content+'">å†…å®¹ï¼š<br>'+comment+'</div>';
                            commentHtml+='</li>';
                        }
                    }else{
                        $('#comment_ul').remove();
                    }
                    $('#comment_ul').empty().append(commentHtml);
                }
            },
            error:function (e) {
                alert('è·å–é¦–é¡µæœ€æ–°æ–‡ç« å’Œç•™è¨€å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•...');
                console.log(e);
            }
        });
    });
</script>
</body>
</html>